/*
 * 7segment.c
 *
 *  Created on: Sep 8, 2025
 *      Author: RND1
 */

#include "main.h"
#include "7segment.h"

void segment_Init(void)
{
  HAL_GPIO_WritePin(GPIOC, GPIO_PIN_14, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(GPIOB, GPIO_PIN_3, GPIO_PIN_RESET);

  HAL_GPIO_WritePin(seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_s0_GPIO_Port, seg_s0_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_s1_GPIO_Port, seg_s1_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_s2_GPIO_Port, seg_s2_Pin, GPIO_PIN_RESET);
  HAL_GPIO_WritePin(seg_s3_GPIO_Port, seg_s3_Pin, GPIO_PIN_RESET);
}

void pickDigit(int x) //light up a 7-segment display
{
  //The 7-segment LED display is a common-cathode one. So also use HAL_GPIO_WritePin to  set d1 as GPIO_PIN_SET and the LED will go out

  switch(x)
  {
    case 3:
      HAL_GPIO_WritePin(seg_s0_GPIO_Port, seg_s0_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s1_GPIO_Port, seg_s1_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s2_GPIO_Port, seg_s2_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s3_GPIO_Port, seg_s3_Pin, GPIO_PIN_SET);
    break;
    case 2:
      HAL_GPIO_WritePin(seg_s0_GPIO_Port, seg_s0_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s1_GPIO_Port, seg_s1_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s2_GPIO_Port, seg_s2_Pin, GPIO_PIN_SET);
      HAL_GPIO_WritePin(seg_s3_GPIO_Port, seg_s3_Pin, GPIO_PIN_RESET);
    break;
    case 1:
      HAL_GPIO_WritePin(seg_s0_GPIO_Port, seg_s0_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s1_GPIO_Port, seg_s1_Pin, GPIO_PIN_SET);
      HAL_GPIO_WritePin(seg_s2_GPIO_Port, seg_s2_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s3_GPIO_Port, seg_s3_Pin, GPIO_PIN_RESET);
    break;
    case 0:
      HAL_GPIO_WritePin(seg_s0_GPIO_Port, seg_s0_Pin, GPIO_PIN_SET);
      HAL_GPIO_WritePin(seg_s1_GPIO_Port, seg_s1_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s2_GPIO_Port, seg_s2_Pin, GPIO_PIN_RESET);
      HAL_GPIO_WritePin(seg_s3_GPIO_Port, seg_s3_Pin, GPIO_PIN_RESET);
    break;
  }
}

void pickNumber(int x)
{
  switch(x)
  {
      case 0:
      HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_SET );
    break;
    case 1:
      HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_SET );
    break;
    case 2:
      HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET );
    break;
    case 3:
      HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_RESET );
      HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_SET );
      HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET );
    break;
     case 4:
       HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_SET );
       HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
       HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
       HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_SET );
       HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_SET );
       HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_RESET );
       HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET );
    break;
      case 5:
        HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_SET );
        HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_SET );
        HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET );
    break;
      case 6:
        HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_SET );
        HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET );
    break;
      case 7:
        HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_SET );
        HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_SET );
        HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_SET );
    break;
      case 8:
        HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET );
    break;
      case 9:
        HAL_GPIO_WritePin( seg_a_GPIO_Port, seg_a_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_b_GPIO_Port, seg_b_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_c_GPIO_Port, seg_c_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_d_GPIO_Port, seg_d_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_e_GPIO_Port, seg_e_Pin, GPIO_PIN_SET );
        HAL_GPIO_WritePin( seg_f_GPIO_Port, seg_f_Pin, GPIO_PIN_RESET );
        HAL_GPIO_WritePin( seg_g_GPIO_Port, seg_g_Pin, GPIO_PIN_RESET );
    break;
  }
}

void seg_diplay(int a)
{
  int first_digit = 0;
  int second_digit = 0;
  int third_digit = 0;
  int fourth_digit = 0;
  int digits[4];
  first_digit = a / 1000;
  digits[0] = first_digit;
  int first_left = a - (first_digit * 1000);
  second_digit = first_left / 100;
  digits[1] = second_digit;
  int second_left = first_left - (second_digit * 100);
  third_digit = second_left / 10;
  digits[2] = third_digit;
  fourth_digit = second_left - (third_digit * 10);
  digits[3] = fourth_digit;

  for(int i = 0; i<4; i++)
  {
  pickDigit(i);
  pickNumber(digits[i]);
  HAL_Delay(1);
  }

}

